<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            touch-action: none;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        /* Canvas ch√≠nh */
        #mainCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            cursor: crosshair;
        }

        /* Overlay n·ªÅn */
        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0) 70%);
            z-index: 0;
            pointer-events: none;
        }

        /* Thanh c√¥ng c·ª• b√™n tr√°i */
        .toolbar {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(25, 25, 35, 0.9);
            border-radius: 20px;
            padding: 15px 10px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tool-btn {
            width: 55px;
            height: 55px;
            border-radius: 15px;
            border: none;
            background: rgba(40, 40, 50, 0.8);
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .tool-btn:hover, .tool-btn.active {
            transform: scale(1.1);
            background: rgba(60, 60, 70, 0.9);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .tool-btn.active {
            background: linear-gradient(135deg, #ff3366, #ff9966);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 51, 102, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 51, 102, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 51, 102, 0); }
        }

        /* B·∫£ng m√†u */
        .color-palette {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(25, 25, 35, 0.9);
            border-radius: 20px;
            padding: 15px 10px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .color-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .color-btn:hover, .color-btn.active {
            transform: scale(1.15);
            border-color: white;
        }

        .color-btn.active::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }

        /* Thanh ƒëi·ªÅu khi·ªÉn d∆∞·ªõi */
        .control-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(25, 25, 35, 0.9);
            border-radius: 20px;
            padding: 15px 20px;
            display: flex;
            gap: 15px;
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .control-btn {
            padding: 12px 25px;
            border-radius: 15px;
            border: none;
            background: rgba(40, 40, 50, 0.8);
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }

        .control-btn:hover {
            background: rgba(60, 60, 70, 0.9);
            transform: translateY(-2px);
        }

        .control-btn.danger {
            background: rgba(255, 51, 102, 0.2);
            color: #ff3366;
        }

        .control-btn.danger:hover {
            background: rgba(255, 51, 102, 0.3);
        }

        /* Th√¥ng tin hi·ªÉn th·ªã */
        .info-panel {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(25, 25, 35, 0.9);
            border-radius: 15px;
            padding: 12px 25px;
            z-index: 10;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            text-align: center;
            min-width: 200px;
            backdrop-filter: blur(10px);
        }

        .info-panel span {
            color: #ffcc00;
            font-weight: bold;
        }

        /* Th√¥ng ƒëi·ªáp ƒë·∫∑c bi·ªát */
        .special-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.98));
            padding: 40px 50px;
            border-radius: 25px;
            z-index: 100;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
            text-align: center;
            max-width: 80%;
            opacity: 0;
            pointer-events: none;
            transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid rgba(255, 51, 102, 0.3);
        }

        .special-message.active {
            opacity: 1;
            pointer-events: all;
            transform: translate(-50%, -50%) scale(1);
        }

        .special-message h1 {
            font-size: 1.8rem;
            color: #ff3366;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .special-message p {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .close-btn {
            background: #ff3366;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: #ff0040;
            transform: scale(1.05);
        }

        /* Hi·ªáu ·ª©ng h·∫°t n·ªÅn */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .toolbar {
                left: 10px;
                padding: 10px 6px;
                gap: 8px;
            }
            
            .tool-btn {
                width: 45px;
                height: 45px;
                font-size: 20px;
            }
            
            .color-palette {
                right: 10px;
                padding: 10px 6px;
                gap: 8px;
            }
            
            .color-btn {
                width: 35px;
                height: 35px;
            }
            
            .control-bar {
                bottom: 10px;
                padding: 10px 15px;
                gap: 10px;
            }
            
            .control-btn {
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .info-panel {
                top: 10px;
                font-size: 12px;
                padding: 8px 15px;
                min-width: 180px;
            }
            
            .special-message {
                padding: 30px 25px;
            }
            
            .special-message h1 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .toolbar {
                flex-direction: row;
                left: 50%;
                top: auto;
                bottom: 80px;
                transform: translateX(-50%);
                width: auto;
            }
            
            .color-palette {
                flex-direction: row;
                right: 50%;
                top: auto;
                bottom: 20px;
                transform: translateX(50%);
                width: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Canvas ch√≠nh -->
    <canvas id="mainCanvas"></canvas>
    
    <!-- Overlay n·ªÅn -->
    <div class="background-overlay"></div>
    
    <!-- H·∫°t n·ªÅn -->
    <div class="particles" id="particles"></div>
    
    <!-- Thanh c√¥ng c·ª• b√™n tr√°i -->
    <div class="toolbar">
        <button class="tool-btn active" id="heartBtn" title="Tr√°i tim">
            ‚ù§Ô∏è
        </button>
        <button class="tool-btn" id="starBtn" title="Ng√¥i sao">
            ‚≠ê
        </button>
        <button class="tool-btn" id="flowerBtn" title="Hoa">
            üå∏
        </button>
        <button class="tool-btn" id="balloonBtn" title="B√≥ng bay">
            üéà
        </button>
        <button class="tool-btn" id="musicBtn" title="N·ªët nh·∫°c">
            üéµ
        </button>
        <button class="tool-btn" id="sparkleBtn" title="Tia l·ª≠a">
            ‚ú®
        </button>
        <button class="tool-btn" id="smileBtn" title="C∆∞·ªùi">
            üòä
        </button>
        <button class="tool-btn" id="diamondBtn" title="Kim c∆∞∆°ng">
            üíé
        </button>
    </div>
    
    <!-- B·∫£ng m√†u b√™n ph·∫£i -->
    <div class="color-palette">
        <button class="color-btn active" style="background-color: #ff3366;" data-color="#ff3366"></button>
        <button class="color-btn" style="background-color: #ff9966;" data-color="#ff9966"></button>
        <button class="color-btn" style="background-color: #ffcc00;" data-color="#ffcc00"></button>
        <button class="color-btn" style="background-color: #33cc66;" data-color="#33cc66"></button>
        <button class="color-btn" style="background-color: #33ccff;" data-color="#33ccff"></button>
        <button class="color-btn" style="background-color: #3366ff;" data-color="#3366ff"></button>
        <button class="color-btn" style="background-color: #9966ff;" data-color="#9966ff"></button>
        <button class="color-btn" style="background-color: #ff33cc;" data-color="#ff33cc"></button>
        <button class="color-btn" style="background-color: #ffffff;" data-color="#ffffff"></button>
        <button class="color-btn" style="background: linear-gradient(45deg, #ff3366, #ffcc00);" data-color="gradient"></button>
    </div>
    
    <!-- Thanh ƒëi·ªÅu khi·ªÉn d∆∞·ªõi -->
    <div class="control-bar">
        <button class="control-btn" id="clearBtn">
            üóëÔ∏è X√≥a t·∫•t c·∫£
        </button>
        <button class="control-btn" id="randomBtn">
            üé≤ Ng·∫´u nhi√™n
        </button>
        <button class="control-btn" id="magicBtn">
            ‚ú® Ph√©p m√†u
        </button>
        <button class="control-btn danger" id="surpriseBtn">
            üíù B·∫•t ng·ªù
        </button>
    </div>
    
    <!-- Th√¥ng tin hi·ªÉn th·ªã -->
    <div class="info-panel" id="infoPanel">
        ƒê√£ th·∫£: <span id="counter">0</span> h√¨nh | Ch·∫ø ƒë·ªô: <span id="mode">Nh·∫•n v√† gi·ªØ</span>
    </div>
    
    <!-- Th√¥ng ƒëi·ªáp ƒë·∫∑c bi·ªát -->
    <div class="special-message" id="specialMessage">
        <h1>T·ªõ xin l·ªói em b√© l·ª£n ng·ªëc c·ªßa t·ªõ nkaaaaa üíñ</h1>
        <p>M·ªói tr√°i tim/ng√¥i sao/h√¨nh ·∫£nh n√†y ƒë·ªÅu l√† l·ªùi xin l·ªói ch√¢n th√†nh c·ªßa t·ªõ!</p>
        <button class="close-btn" id="closeMessageBtn">ƒê√≥ng</button>
    </div>

    <script>
        // Kh·ªüi t·∫°o canvas
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        
        // Bi·∫øn to√†n c·ª•c
        let particles = [];
        let isDrawing = false;
        let currentShape = 'heart';
        let currentColor = '#ff3366';
        let particleCounter = 0;
        let lastEmitTime = 0;
        const emitRate = 50; // ms gi·ªØa m·ªói l·∫ßn th·∫£
        let specialMode = false;
        
        // K√≠ch th∆∞·ªõc canvas
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // L·ªõp Particle
        class Particle {
            constructor(x, y, shape, color) {
                this.x = x;
                this.y = y;
                this.shape = shape;
                this.color = color;
                this.size = Math.random() * 25 + 15;
                this.speedY = Math.random() * 3 + 2;
                this.speedX = Math.random() * 4 - 2;
                this.gravity = 0.1;
                this.velocity = 0;
                this.angle = Math.random() * Math.PI * 2;
                this.spin = Math.random() * 0.05 - 0.025;
                this.opacity = 1;
                this.life = 1.0;
                this.decay = Math.random() * 0.002 + 0.001;
                
                // Hi·ªáu ·ª©ng ƒë·∫∑c bi·ªát cho gradient
                if (color === 'gradient') {
                    this.gradientColors = [
                        '#ff3366', '#ff9966', '#ffcc00', '#33cc66',
                        '#33ccff', '#3366ff', '#9966ff', '#ff33cc'
                    ];
                    this.color = this.gradientColors[Math.floor(Math.random() * this.gradientColors.length)];
                }
                
                // Hi·ªáu ·ª©ng cho t·ª´ng lo·∫°i h√¨nh
                switch(shape) {
                    case 'sparkle':
                        this.twinkle = Math.random() * 0.1 + 0.9;
                        this.twinkleSpeed = Math.random() * 0.02 + 0.01;
                        break;
                    case 'balloon':
                        this.speedY = Math.random() * 2 + 1; // Bay ch·∫≠m h∆°n
                        this.gravity = -0.05; // Bay l√™n
                        break;
                }
            }
            
            update() {
                // V·∫≠t l√Ω r∆°i
                this.velocity += this.gravity;
                this.y += this.speedY + this.velocity;
                this.x += this.speedX;
                this.angle += this.spin;
                
                // Gi·∫£m d·∫ßn opacity
                this.life -= this.decay;
                this.opacity = this.life;
                
                // Hi·ªáu ·ª©ng nh·∫•p nh√°y cho sparkle
                if (this.shape === 'sparkle') {
                    this.twinkle += this.twinkleSpeed;
                    const brightness = Math.sin(this.twinkle) * 0.3 + 0.7;
                    this.opacity = this.life * brightness;
                }
                
                // Ki·ªÉm tra n·∫øu ra kh·ªèi m√†n h√¨nh ho·∫∑c h·∫øt life
                if (this.y > canvas.height + 100 || this.x < -100 || this.x > canvas.width + 100 || this.life <= 0) {
                    return false;
                }
                
                // N·∫£y l√™n khi ch·∫°m ƒë√°y
                if (this.y > canvas.height - 50 && this.velocity > 0) {
                    this.velocity = -this.velocity * 0.7;
                    this.y = canvas.height - 50;
                }
                
                return true;
            }
            
            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity;
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);
                
                // V·∫Ω h√¨nh theo lo·∫°i
                switch(this.shape) {
                    case 'heart':
                        drawHeart(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'star':
                        drawStar(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'flower':
                        drawFlower(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'balloon':
                        drawBalloon(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'music':
                        drawMusicNote(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'sparkle':
                        drawSparkle(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'smile':
                        drawSmile(ctx, 0, 0, this.size, this.color);
                        break;
                    case 'diamond':
                        drawDiamond(ctx, 0, 0, this.size, this.color);
                        break;
                }
                
                ctx.restore();
            }
        }
        
        // H√†m v·∫Ω c√°c h√¨nh
        function drawHeart(ctx, x, y, size, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            const topCurveHeight = size * 0.3;
            ctx.moveTo(x, y + size/4);
            // V·∫Ω n·ª≠a tr√°i
            ctx.bezierCurveTo(
                x, y, 
                x - size/2, y, 
                x - size/2, y + size/3
            );
            // V·∫Ω ƒë√°y nh·ªçn
            ctx.bezierCurveTo(
                x - size/2, y + size - topCurveHeight,
                x, y + size,
                x, y + size
            );
            // V·∫Ω n·ª≠a ph·∫£i
            ctx.bezierCurveTo(
                x, y + size,
                x + size/2, y + size - topCurveHeight,
                x + size/2, y + size/3
            );
            // Ho√†n th√†nh
            ctx.bezierCurveTo(
                x + size/2, y,
                x, y,
                x, y + size/4
            );
            ctx.closePath();
            ctx.fill();
            
            // Hi·ªáu ·ª©ng b√≥ng
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            ctx.beginPath();
            ctx.ellipse(x - size/6, y + size/6, size/8, size/10, 0, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function drawStar(ctx, x, y, size, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            const spikes = 5;
            const outerRadius = size/2;
            const innerRadius = size/4;
            
            for(let i = 0; i < spikes * 2; i++) {
                const radius = i % 2 === 0 ? outerRadius : innerRadius;
                const angle = Math.PI / spikes * i;
                const px = x + Math.cos(angle) * radius;
                const py = y + Math.sin(angle) * radius;
                
                if(i === 0) {
                    ctx.moveTo(px, py);
                } else {
                    ctx.lineTo(px, py);
                }
            }
            ctx.closePath();
            ctx.fill();
            
            // Hi·ªáu ·ª©ng l·∫•p l√°nh
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.beginPath();
            ctx.arc(x - size/4, y - size/4, size/8, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function drawFlower(ctx, x, y, size, color) {
       
